const http = require('http');
let input = process.argv.slice(2).join(" ").trim();

const map = { "1": "ğŸ…", "2": "ğŸ„", "3": "ğŸ””", "4": "ğŸ‰","5": "ğŸ‡","6": "ğŸ“","7": "ğŸ’","8": "ğŸ","9": "ğŸ¥­","0": "ğŸ‘","a": "ğŸ", "b": "ğŸ”", "c": "ğŸ•", "d": "ğŸ©", "e": "ğŸª", "f": "ğŸ»", "g": "ğŸ¼", "h": "ğŸ«", "i": "ğŸ¬", "j": "ğŸ­", "k": "ğŸ®", "l": "ğŸ¯", "m": "ğŸ´", "n": "ğŸ·", "o": "ğŸ¸", "p": "ğŸ¹", "q": "ğŸº", "r": "ğŸ»", "s": "ğŸ½ï¸", "t": "ğŸ¾", "u": "ğŸ¿", "v": "ğŸ‚", "w": "ğŸ ", "x": "ğŸ¢", "y": "ğŸ¥", "z": "ğŸ¨", "A": "ğŸ™ˆ", "B": "ğŸ‘¾", "C": "ğŸ¤ª", "D": "ğŸ¤‘", "E": "ğŸ", "F": "ğŸ“", "G": "ğŸ–ï¸", "H": "ğŸï¸", "I": "ğŸ˜ˆ", "J": "ğŸŸï¸", "K": "ğŸ¡", "L": "ğŸ¢", "M": "ğŸ£", "N": "ğŸ¤", "O": "ğŸ¥", "P": "ğŸ¦", "Q": "ğŸ¨", "R": "ğŸ©", "S": "ğŸª", "T": "ğŸ›³","U": "ğŸš¡","V": "ğŸš‹","W": "ğŸš","X": "ğŸš²","Y": "ğŸš‚","Z": "ğŸš€","!": "â•","\"": "â¤ï¸","#": "ğŸ’”","$": "ğŸ’°","%": "ğŸ’¯","&": "ğŸ’œ","'": "ğŸ’˜","(": "ğŸ‘",")": "ğŸ‘","*": "âœ¨","+": "â•",",": "ğŸ’â€â™‚ï¸","-": "â–",".": "ğŸ’â€â™€ï¸","/": "ğŸ—¡ï¸",":": "ğŸ’â€â™‚ï¸",";": "ğŸ’â€â™€ï¸","<": "ğŸ”™","=": "ğŸ”š",">": "ğŸ”œ","?": "â“","@": "ğŸ’¬","[": "ğŸ”","\\": "â¬†ï¸","]": "ğŸ”œ","^": "ğŸ”º","_": "ğŸ”»","`": "â„ï¸","{": "ğŸ”’","|": "ğŸ”","}": "ğŸ”“","~": "ğŸŒŸ" };
const flag = "ğŸ’°ğŸ”’ğŸ‡ğŸ’¬ğŸ¤ğŸ’ğŸ’¬ğŸ‡ğŸ”»ğŸ¤ªğŸ‘ğŸ¤‘ğŸğŸ”»ğŸ˜ˆğŸ‡ğŸ”»ğŸ‘¾ğŸ‘ğŸ“ğŸš¡ğŸ‡ğŸ”»ğŸ˜ˆğŸ”»ğŸ¤ªğŸ”»ğŸ‘ğŸ¢ğŸ¤‘ğŸğŸ™ˆğŸ¤‘ğŸ¤ªğŸ‘ğŸ¤‘ğŸâ•ğŸ”“";
const decode = (data) => {
    let newString = "";
    Array.from(data).forEach((char) => {
        if(map.hasOwnProperty(char)) newString += map[char];
        else if(Object.values(map).includes(char)) {
            newString += Object.keys(map)[Object.values(map).indexOf(char)];
        }
        else newString += char;
    })
    return newString;
}

console.log(decode(flag));

const defaultOptions = {
    host: 'santascodeconsole.norwayeast.azurecontainer.io',
    port: 8192,    
    headers: { 'Content-Type': 'application/json' }
}

const post = (path, payload) => new Promise((resolve, reject) => {
    const options = { ...defaultOptions, path, method: 'POST' };
    const req = http.request(options, res => {
        let buffer = "";
        res.on('data', chunk => buffer += chunk)
        res.on('end', () => resolve(JSON.parse(buffer)))
    });
    req.on('error', e => reject(e.message));
    req.write(JSON.stringify(payload));
    req.end();
});

input = "31131122211311123113321112131221123113111231121113311211131221121321131211132221123113112211121312211231131122211211133112111311222112111312211312111322211213211321322123211211131211121332211231131122211311122122111312211213211312111322211231131122211311123113322112111331121113112221121113122113111231133221121113122113121113222123211211131211121332211213211321322113311213211322132112311321322112111312212321121113122122211211232221123113112221131112311332111213122112311311123112111331121113122112132113311213211321222122111312211312111322212321121113121112133221121321132132211331121321132213211231132132211211131221232112111312212221121123222112132113213221133112132123123112111311222112132113311213211231232112311311222112111312211311123113322112132113212231121113112221121321132122211322212221121123222112311311222113111231133211121312211231131112311211133112111312211213211312111322211231131122211311123113322113223113112221131112311332211211131221131211132211121312211231131112311211232221121321132132211331221122311311222112111312211311123113322112132113213221133122211332111213112221133211322112211213322112111312211312111322212321121113121112131112132112311321322112111312212321121113122112131112131221121321132132211231131122211331121321232221121113122113121122132112311321322112111312211312111322211213111213122112132113121113222112132113213221133112132123222112311311222113111231132231121113112221121321133112132112211213322112111312211312111322212311222122132113213221123113112221133112132123222112111312211312111322212321121113121112133221121311121312211213211312111322211213211321322123211211131211121332211213211321322113311213212312311211131122211213211331121321122112133221123113112221131112311332111213122112311311123112111331121113122112132113121113222112311311222113111221221113122112132113121113222112132113213221133122211332111213322112132113213221132231131122211311123113322112111312211312111322212321121113122123211231131122113221123113221113122112132113213211121332212311322113212221";
(async () => {
    for (let i = 0; i<100; i++) {
        
        let data = { code: input };
        const token = await post("/eval", data);
        // console.log(`Sending: ${data.code}`);
        // console.log(`Result: ${token.result}`);
        // console.log(`Result Decoded: ${decode(token.result)}`);
        input = token.result;
        console.log(`Status: ${decode(input)} ${token.status}`);
        
    }
})()

